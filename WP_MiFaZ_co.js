var WP_MiFaZ=function(){function r(a){m.get(ajaxRequestUrl,"?f=getLocationsFromPart&locationPart="+a.value+"&maxLocations=5&format=json",function(b){s(a,b)});a.onkeyup=null}function t(a){a=document.getElementById(a.id+"List");if(j(a)){var b=[],b=k(a,"MiFaZListElementMarked");b[0].nextSibling!=null&&(l(b[0].nextSibling,"MiFaZListElementMarked"),n(b[0],"MiFaZListElementMarked"))}else a=a.getElementsByTagName("li")[0],l(a,"MiFaZListElementMarked")}function u(a){a=document.getElementById(a.id+"List"); if(j(a)){var b=[],b=k(a,"MiFaZListElementMarked");b[0].previousSibling!=null&&(l(b[0].previousSibling,"MiFaZListElementMarked"),n(b[0],"MiFaZListElementMarked"))}}function v(a){a=document.getElementById(a.id+"List");if(j(a)){var b=[],b=k(a,"MiFaZListElementMarked");b[0].getElementsByTagName("a")[0].onclick()}}function w(a){a=a||window.event;return a.keyCode}function k(a,b){var e=[],c=[],c=a.getElementsByTagName("*"),d=0;for(i=0;i<c.length;i++)h(c[i],b)&&(e[d]=c[i],d++);return e}function j(a){var b= [],b=a.getElementsByTagName("*");for(i=0;i<b.length;i++)if(h(b[i],"MiFaZListElementMarked"))return!0;return!1}function h(a,b){return a.className.match(RegExp("(\\s|^)"+b+"(\\s|$)"))}function l(a,b){h(a,b)||(a.className+=" "+b)}function n(a,b){if(h(a,b))a.className=a.className.replace(RegExp("(\\s|^)"+b+"(\\s|$)")," ")}function s(a,b){data=eval("("+b+")");var e=document.createElement("ul"),c=data.locations;if(c.length==0)document.getElementById(a.id+"List").style.display="none";else{for(var d=0;d< c.length;d++){var g=document.createElement("li"),f=document.createElement("a");f.onclick=function(b){return function(){var e=c[b].name,d=c[b].locID;document.getElementById(a.id+"List").replaceChild(document.createElement("p"),document.getElementById(a.id+"List").firstChild);document.getElementById(a.id+"Value").value=d;document.getElementById(a.id).value=e}}(d);f.appendChild(document.createTextNode(c[d].name));g.appendChild(f);e.appendChild(g)}document.getElementById(a.id+"List").replaceChild(e,document.getElementById(a.id+ "List").firstChild);document.getElementById(a.id+"List").style.display="block"}}function x(a){document.getElementById("MiFaZInfo").style.display="none";var b=document.getElementById("MiFazLoc1").value,e=document.getElementById("MiFazLoc2").value,c=document.createElement("img");c.setAttribute("src",o+"/bahn_logo.png");var d=document.createElement("a");d.setAttribute("href","http://partners.webmasterplan.com/click.asp?ref=418387&site=2894&type=text&tnb=46&diurl=http://reiseauskunft.bahn.de/bin/query.exe/dn?searchMode=ADVANCED&S="+ b+"&start=1&Z="+e+"&timesel=depart&application=CONNECTIONS&dbkanal_004=L01_S01_D001_KPK0002_mifaz_LZ03");d.appendChild(c);b=document.createElement("li");b.appendChild(d);d=document.createElement("ul");a=eval("("+a+")");a=a.entries;a.length==0&&(e=document.createElement("li"),e.appendChild(document.createTextNode("Es wurden leider keine Eintr\u00e4ge gefunden. Versuchen Sie es doch mit der Bahn.")),d.appendChild(e));for(c=0;c<a.length;c++){var e=document.createElement("li"),g=document.createElement("a"); g.setAttribute("href",a[c].url);var f="von "+a[c].startloc+" nach "+a[c].goalloc;a[c].stopovernames!=""&&a[c].stopovernames!=void 0&&(f+=" \u00dcber "+a[c].stopovernames);a[c].journeydate!=""&&a[c].journeydate!=void 0&&(f+="<br />am: "+a[c].journeydate);a[c].times!=""&&a[c].times!=void 0&&(f+="<br />Regelm\u00e4\u00dfig: "+a[c].times);a[c].toleranceback!=""&&a[c].toleranceback!=void 0&&(f+=a[c].toleranceback);a[c].starttimebegin!=""&&a[c].starttimebegin!=void 0&&(f+="<br />um "+a[c].starttimebegin); g.innerHTML=f;e.appendChild(g);d.appendChild(e)}d.appendChild(b);document.getElementById("MiFaZResults").replaceChild(d,document.getElementById("MiFaZResults").firstChild)}function p(a){document.getElementById("MiFaZInfo").style.display="block";document.getElementById("MiFaZInfo").innerHTML=a}var o="",q="",m=function(){function a(){var a=!1;typeof XMLHttpRequest!="undefined"&&(a=new XMLHttpRequest);if(!a)try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(d){a= null}}return a}function b(a){a==null&&(a=function(){});return a}return{get:function(e,c,d,g){var f=a(),d=b(d),g=b(g);f.open("get",e+c,!0);f.onreadystatechange=function(){f.readyState==4&&(f.status==200?d(f.responseText):g())};f.send(null)}}}();return{init:function(a){o=a;ajaxRequestUrl=a+"/getRequests.php";q='<img src="'+a+'/spinner.gif" border="0" />';document.getElementById("MiFazLoc1")!=null&&WP_MiFaZ.autocompleter(document.getElementById("MiFazLoc1"));document.getElementById("MiFazLoc2")!=null&& WP_MiFaZ.autocompleter(document.getElementById("MiFazLoc2"));document.getElementById("MiFazInputs").style.display="block"},autocompleter:function(a){a.onfocus=function(){document.getElementById(a.id+"List").style.display="block"};a.onblur=function(){window.setTimeout("document.getElementById('"+a.id+"List').style.display = 'none'",200)};a.onkeydown=function(b){b=w(b);switch(b){case 40:t(a);break;case 38:u(a);break;case 13:v(a)}if(b>=65&&b<=90||b==222||b==192||b==186||b==219||b==59||b==8||b==46)a.onkeyup= function(){r(a)}}},sendRequest:function(){var a=document.getElementById("MiFazLoc1Value").value,b=document.getElementById("MiFazLoc2Value").value,e="";a==-1&&(e+="Bitte geben Sie einen Startort ein");b==-1&&(e+="Bitte geben Sie einen Zielort ein");a!=-1&&b!=-1&&(e="Einen Moment bitte"+q,m.get(ajaxRequestUrl,"?f=getEntries&startID="+a+"&goalID="+b+"&format=json",function(a){document.getElementById("MiFaZInfo").innerHTML="";x(a)},function(){p("Leider konnte Ihre Anfrage nicht bearbeitet werden. Versuchen Sie es bitte zu einen sp\u00e4teren Zeitpunkt erneut")})); p(e)}}}();